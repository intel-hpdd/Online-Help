jobs:
  include:
    - stage: test
      env: Type='virus scan'
      script:
        - sudo apt-get install clamav -y
        - sudo freshclam
        - clamscan --quiet -r ./
    - stage: test
      env: Type='build'
      language: ruby
      rvm: 2.1
      install:
        - . $HOME/.nvm/nvm.sh
        - nvm install 6
        - nvm use 6
        - npm install -g npm@latest
        - bundle install --jobs=3 --retry=3
      script: 
        - node --version
        - npm --version
        - npm run postversion
      deploy:
        provider: npm
        skip_cleanup: true
        email: "$NPM_EMAIL"
        api_key: "$NPM_TOKEN"
        on:
          tags: true
          repo: intel-hpdd/Online-Help
